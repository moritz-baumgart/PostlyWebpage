<p-tabView id="startTabs">
    <!--A tab view with 2 tabs, recommended and following-->
    <p-tabPanel header="Recommended">
        <div id="skeletonContainer" *ngIf="posts.length == 0">
            <p-skeleton *ngFor="let height of skeletonHeights" class="skeleton-appear" height="{{height + 'rem'}}"
                width="100%"></p-skeleton>
        </div>
        <!-- when loading the skeletons above are shown, otherwise the actual posts blow -->
        <div id="postContainer" class="post">
            <div *ngFor="let post of posts" class="post" (click)="showPostDetails(post)">
                <div class="post-contents">
                    <span *ngIf="post.author.displayName" class="username">{{ post.author.displayName }} (@{{ post.author.username }})</span>
                    <span *ngIf="!post.author.displayName" class="username">@{{ post.author.username }}</span>
                    <span class="post-time">{{ post.createdAt | date:'medium' }}</span>
                    <span>{{ post.content }}</span>
                </div>
                <app-poststats [post]="post"></app-poststats>
            </div>
        </div>
    </p-tabPanel>
    <p-tabPanel header="Following">
        <!-- TODO: The following posts -->
    </p-tabPanel>

    <!-- below is the overlay dialog for a detailed view of posts, it contains the abilitiy to comment, etc. -->
    <p-dialog [header]="postDetails?.header || ''" [(visible)]="postDetailsVisible" [modal]="true" [style]="{ width: '50vw' }" [draggable]="false" [resizable]="false" id="postDetailsDialog">
        <span>{{ postDetails?.content }}</span>
        <app-poststats [post]="postDetails?.post" [paddingLeft]="'0'" [paddingBottom]="'0'"></app-poststats>
        <p-divider></p-divider>
        <ng-container *ngIf="postDetails?.comments">
            <span *ngIf="postDetails?.comments?.length == 0">No comments...</span>
            <ng-container *ngFor="let comment of postDetails?.comments; let i = index">
                <div>
                    <span *ngIf="comment.author.displayName" class="username">{{ comment.author.displayName }} (@{{ comment.author.username }})</span>
                    <span *ngIf="!comment.author.displayName" class="username">@{{ comment.author.username }}</span>
                    <span> | </span>
                    <span class="post-time">{{ comment.createdAt | date:'medium' }}</span>
                </div>
                <span>{{ comment.content }}</span>
                <p-divider></p-divider>
            </ng-container>
            <span class="p-float-label" id="commentArea">
                <textarea rows="5" pInputTextarea [(ngModel)]="commentText"></textarea>
                <label for="float-input">Leave a comment...</label>
            </span>
            <div id="commentButtonContainer">
                <!-- TODO: CONTINUE HERE, add function to these btns. Then add the ability to upvote downvote, when closing the dialog the comment should be temporary saved by post id or smth -->
                <p-button label="Discard" class="comment-btn-margin" styleClass="p-button-sm p-button-danger p-button-outlined"></p-button>
                <p-button label="Post" class="comment-btn-margin" styleClass="p-button-sm p-button-success "></p-button>
            </div>
        </ng-container>
        <ng-container *ngIf="postDetails?.comments == null">
            <div id="commentSkeletonContainer" *ngFor="let _ of Array(4).fill(0)">
                <p-skeleton height="3rem" width="100%"></p-skeleton>
                <div class="skeleton-spacer"></div>
            </div>
        </ng-container>
    </p-dialog>

</p-tabView>
